var Core=(function(){var _array=function(iterable){if(!iterable){return[];}if("toArray" in Object(iterable)){return iterable.toArray()}var length=iterable.length||0,results=new Array(length);while(length--){results[length]=iterable[length]}return results};var _each=function(iterable,iterator){var array=_array(iterable);for(var i=0,length=array.length;i<length;i++){iterator(array[i])}};var _filter=function(iterable,iterator,context){var results=[];_each(iterable,function(value,index){if(iterator.call(context,value,index)){results.push(value)}});return results};var _try=function(){var returnValue;for(var i=0,length=arguments.length;i<length;i++){var lambda=arguments[i];try{returnValue=lambda();break}catch(e){}}return returnValue};var _core_path=(function(){var _p="";_each(_filter(document.getElementsByTagName("script"),function(t){return(t.src&&t.src.match(/\/th2w\.core\.js(\?.*)?$/))}),function(t){_p=t.src.replace(/\/th2w\.core\.js(\?.*)?$/,"")});return _p})();var _url="";var _path=function(_p){var _ib=_p.indexOf("./")==0;return _ib?(_url+_p.substring(1)):_core_path+"/"+_p};var _exjs=function(_js){if(!_pool[_js]){_queue.push(_path(_js)+".js");_pool[_js]=true}};var _queue=new Array();var _pool=[];var _loadJs=function(){_each(arguments,_exjs);_doJs()};var _doJs=function(){var script=document.createElement("script");script.type="text/javascript";script.src=_queue.shift();script.async="async";document.getElementsByTagName("head")[0].appendChild(script);script.onload=script.onreadystatechange=function(){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){if(_queue.length>0){_doJs()}else{_doFn()}}script.onload=script.onreadystatechange=null}};var _cpool=[];var _excss=function(_css){if(!_cpool[_css]){_doCss(_path(_css)+".css");_cpool[_css]=true}};var _loadCss=function(){_each(arguments,_excss)};var _doCss=function(_href){var css=document.createElement("link");css.rel="stylesheet";css.type="text/css";css.href=_href;document.getElementsByTagName("head")[0].appendChild(css)};var _fqueue=new Array();var _exfn=function(_fn){if(_queue.length>0){_fqueue.push(_fn)}else{_fn()}};var _doFn=function(){while(_fqueue.length>0){_fqueue.shift()()}};var _loadFn=function(){_each(arguments,_exfn)};var _init=function(_obj){if(_obj.url){_url=_obj.url}if(_obj.css){_each(_obj.css,_excss)}if(_obj.js){_each(_obj.js,_exjs);_doJs()}if(_obj.fn){_each(_obj.fn,_exfn)}};return{"init":_init,"js":_loadJs,"css":_loadCss,"fn":_loadFn,"path":_path}})();